{"title":"GenAI Support Bot: Health & Safety","description":"[[suggested_dashboards]]","widgets":[{"id":2166047164604685,"definition":{"title":"trace duration","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"metrics","query":"avg:ml_obs.trace.duration{service:vertex-chat-bot}"}],"formulas":[{"formula":"query1"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":8655088962000621,"definition":{"title":"Sensitive data detection","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"llm_observability","name":"query1","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[],"search":{"query":"sensitive_data:*"}}],"conditional_formats":[{"comparator":">=","value":200,"palette":"white_on_red"},{"comparator":"<=","value":150,"palette":"white_on_yellow"},{"comparator":"<=","value":50,"palette":"white_on_green"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":0,"width":4,"height":2}},{"id":4651541872284272,"definition":{"title":"Sentiment","title_size":"16","title_align":"left","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"spans","search":{"query":"service:vertex-chat-bot"},"indexes":["*"],"group_by":[{"facet":"@user.emotion","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"style":{"palette":"datadog16"},"formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"type":"sunburst","legend":{"type":"table"}},"layout":{"x":8,"y":0,"width":4,"height":4}},{"id":412178991385970,"definition":{"title":"Input tokens vs output tokens","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:ml_obs.span.llm.input.tokens{service:vertex-chat-bot} by {model_name}"},{"data_source":"metrics","name":"query2","query":"avg:ml_obs.span.llm.output.tokens{service:vertex-chat-bot} by {model_name}"}],"formulas":[{"style":{"palette":"warm"},"formula":"query1"},{"style":{"palette":"blue"},"formula":"query2"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":4,"height":2}},{"id":246492188202974,"definition":{"title":"RAG vs input tokens","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query2","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[],"compute":{"aggregation":"avg","metric":"@rag.context_size","interval":300000},"storage":"hot"},{"data_source":"metrics","name":"query1","query":"avg:ml_obs.span.llm.prompt.tokens{*}"}],"formulas":[{"alias":"rag_tokens","style":{"palette":"classic","palette_index":1},"formula":"query2"},{"style":{"palette":"orange","palette_index":4},"formula":"query1"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":4,"y":2,"width":4,"height":2}},{"id":6154190772084494,"definition":{"title":"Confusion score","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"spans","search":{"query":"@user.confusion_score:*"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"avg","metric":"@user.confusion_score"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"comparison":{"type":"absolute","duration":{"type":"previous_timeframe"},"directionality":"decrease_better"},"conditional_formats":[{"comparator":"<","value":0.3,"palette":"white_on_green"},{"comparator":">","value":0.5,"palette":"white_on_yellow"},{"comparator":">","value":0.7,"palette":"white_on_red"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":0,"y":4,"width":2,"height":2}},{"id":7488035513090442,"definition":{"title":"User Messages per session","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:chatbot.session.chat_length{*}","aggregator":"avg"}],"conditional_formats":[{"comparator":"<","value":2,"palette":"white_on_green"},{"comparator":">=","value":2,"palette":"white_on_yellow"},{"comparator":">=","value":5,"palette":"white_on_red"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area","yaxis":{"include_zero":true}}},"layout":{"x":2,"y":4,"width":2,"height":2}},{"id":1524698890797049,"definition":{"title":"Was RAG Relevant","title_size":"16","title_align":"left","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"spans","search":{"query":"@rag_relevant:*"},"indexes":["*"],"group_by":[{"facet":"@rag_relevant","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"}}],"compute":{"aggregation":"count"},"storage":"hot"}],"style":{"palette":"datadog16"},"formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"type":"sunburst","legend":{"type":"automatic"}},"layout":{"x":4,"y":4,"width":4,"height":4}},{"id":3029631813515283,"definition":{"title":"Is a Query","title_size":"16","title_align":"left","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[{"facet":"@critic_query_classification","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"style":{"palette":"semantic"},"formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"type":"sunburst","legend":{"type":"automatic"}},"layout":{"x":8,"y":4,"width":4,"height":4}},{"id":1267149328037358,"definition":{"title":"Answer Relevancy","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query2","data_source":"spans","search":{"query":"env:dev @answer_relevant:yes"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"},{"name":"query1","data_source":"spans","search":{"query":"env:dev @answer_relevant:*"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"conditional_formats":[{"comparator":"<","value":20,"palette":"white_on_red"},{"comparator":"<","value":80,"palette":"white_on_yellow"},{"comparator":">=","value":80,"palette":"white_on_green"}],"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"percent"}},"formula":"(query2 / query1) * 100"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":0,"y":6,"width":4,"height":2}},{"id":7942079599533795,"definition":{"title":"Queries by RAG type","title_size":"16","title_align":"left","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"spans","search":{"query":"@rag_type:*"},"indexes":["*"],"group_by":[{"facet":"@rag_type","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"style":{"palette":"datadog16"},"formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"type":"sunburst","legend":{"type":"automatic"}},"layout":{"x":0,"y":8,"width":4,"height":4}},{"id":3012381664945005,"definition":{"title":"Confusion score by Category","title_size":"16","title_align":"left","type":"bar_chart","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[{"facet":"@user.topic","limit":10,"sort":{"aggregation":"avg","order":"desc","metric":"@user.confusion_score"}}],"compute":{"aggregation":"avg","metric":"@user.confusion_score"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"response_format":"scalar"}],"style":{"display":{"type":"stacked","legend":"inline"}}},"layout":{"x":4,"y":8,"width":4,"height":4}},{"id":6477812295951881,"definition":{"title":"Request volume by topic","title_size":"16","title_align":"left","type":"toplist","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[{"facet":"@user.topic","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","formulas":[{"formula":"query1"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"style":{"display":{"type":"stacked","legend":"inline"}}},"layout":{"x":8,"y":8,"width":4,"height":2}}],"template_variables":[],"layout_type":"ordered","notify_list":[],"reflow_type":"fixed","pause_auto_refresh":false}